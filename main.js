(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=e.id,this._link=e.link,this._name=e.name,this._cardSelector=n,this._handleCardClick=r,this._handleDeleteButtonClick=o}var n,r;return n=t,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".elements__element").cloneNode(!0)}},{key:"_setEventListeners",value:function(){this._element.querySelector(".elements__like").addEventListener("click",this._toggleLike),this._element.querySelector(".elements__deleteButton").addEventListener("click",this._handleDeleteButtonClick),this._element.querySelector(".elements__image").addEventListener("click",this._handleCardClick)}},{key:"_toggleLike",value:function(e){e.target.classList.toggle("elements__like_active")}},{key:"getCard",value:function(){return this._element=this._getTemplate(),this._setEventListeners(),this._element.id=this._id,this._element.querySelector(".elements__name").textContent=this._name,this._element.querySelector(".elements__image").src=this._link,this._element.querySelector(".elements__image").alt=this._name,this._element}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._cardElements=document.querySelector(n)}var t,r;return t=e,(r=[{key:"renderAll",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._cardElements.append(e)}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(".popup"),this._form=document.querySelector(t),this._handleEscClose=function(e){"Escape"===e.key&&n.close()}}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.remove("hidden"),this._popup.classList.add("visible"),this._form.classList.remove("hidden"),this._form.classList.add("visible"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.add("hidden"),this._popup.classList.remove("visible"),this._form.classList.add("hidden"),this._form.classList.remove("visible"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var e=this;document.addEventListener("click",(function(t){t.target.classList.contains("popup")&&e.close()})),this._form.addEventListener("click",(function(t){t.target.classList.contains("exitButton")&&e.close()}))}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},u.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function f(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(c,e);var t,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,e))._bigCardImage=document.querySelector(".popup__image"),t._bigCardCaption=document.querySelector(".popup__caption"),t}return t=c,(n=[{key:"open",value:function(e,t){this._bigCardImage.src=e,this._bigCardCaption.textContent=t,u(p(c.prototype),"open",this).call(this)}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(i);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(){return _="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=m(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_.apply(this,arguments)}function m(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}function b(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(c,e);var t,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(r);if(o){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return b(this,e)});function c(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=i.call(this,e))._submitHandler=t,n}return t=c,(n=[{key:"_getInputValues",value:function(){var e=this,t=this._form.querySelectorAll(".popup__input");this._formValues={},t.forEach((function(t){e._formValues[t.name]=t.value}))}},{key:"setEventListeners",value:function(){_(g(c.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",this._submitHandler)}},{key:"close",value:function(){_(g(c.prototype),"close",this).call(this),this._form.reset()}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(i);function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(t){var n=t.userNameSelector,r=t.occupationSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._profileName=document.querySelector(n),this._profileOccupation=document.querySelector(r)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._profileName.textContent,occupation:this._profileOccupation.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.occupation;this._profileName.textContent=t,this._profileOccupation.textContent=n}}])&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._inputList=Array.from(n.querySelectorAll(t.inputSelector)),this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(t){e._handleValidity(t)}))}))}},{key:"_handleValidity",value:function(e){var t=e.target;t.validity.valid?this._hideError(t):this._showError(t),this._checkSubmitterAvailability()}},{key:"_checkSubmitterAvailability",value:function(){var e=this._inputList[0].form.querySelector(this._submitButtonSelector);this._inputList.every((function(e){return e.validity.valid}))?(e.classList.remove(this._inactiveButtonClass),e.disabled=!1):(e.classList.add(this._inactiveButtonClass),e.disabled=!0)}},{key:"_showError",value:function(e){e.classList.add(this._inputErrorClass);var t=e.form.querySelector("."+this._errorClass+e.id);t.classList.remove("hidden"),t.textContent=e.validationMessage}},{key:"_hideError",value:function(e){e.classList.remove(this._inputErrorClass),e.form.querySelector("."+this._errorClass+e.id).classList.add("hidden")}}])&&O(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._server=t}var t,n;return t=e,(n=[{key:"getCards",value:function(){return fetch(this._server,{method:"GET"}).then((function(e){return e.json()}))}},{key:"addCard",value:function(e){return fetch(this._server,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}).then((function(e){return e.json()}))}},{key:"deleteCard",value:function(e){return fetch(this._server+"/"+e,{method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){return e.json()}))}}])&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),L=document.querySelector(".type_new-item .popup__input_type_line-one"),P=document.querySelector(".type_new-item .popup__input_type_line-two"),q=document.querySelector(".elements"),B=document.querySelector(".type_profile .popup__input_type_line-one"),R=document.querySelector(".type_profile .popup__input_type_line-two"),T=document.querySelector(".profile__editButton"),x=document.querySelector(".profile__addButton"),I={formSelector:".popup__container",inputSelector:".popup__input",submitButtonSelector:".popup__saveButton",inactiveButtonClass:"popup__saveButton_error",inputErrorClass:"popup__input_style-error",errorClass:"popup__input-error_place_line"},A=void 0,D=new j("http://127.0.0.1:3002/cards"),V=new d(".popup__big-card");V.setEventListeners();var N=new w(".type_profile",(function(e){e.preventDefault(),N._getInputValues(),H.setUserInfo(N._formValues),N.close()}));N.setEventListeners(),T.addEventListener("click",(function(){var e=H.getUserInfo();B.value=e.name,R.value=e.occupation,N.open()}));var U=new w(".type_new-item",(function(e){e.preventDefault();var n=L.value,r=P.value;D.addCard("name="+encodeURIComponent(n)+"&link="+encodeURIComponent(r)).then((function(e){var o={id:Number(e),name:n,link:r},i=new t(o,"#card-template",(function(e){return V.open(e.target.src,e.target.alt)}),(function(e){var t=e.target.closest(".elements__element");D.deleteCard(t.id).then((function(e){return t.remove()})).catch((function(e){return console.log(e.message)}))})),c=i.getCard();A.addItem(c),U.close()})).catch((function(e){console.log(e.message)}))}));U.setEventListeners(),x.addEventListener("click",(function(){U.open()}));var H=new S({userNameSelector:".profile__name",occupationSelector:".profile__occupation"});H.setUserInfo({name:"Жак-Ив Кусто",occupation:"Исследователь океана"});var G=I.formSelector,M=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(I,["formSelector"]);Array.from(document.querySelectorAll(G)).forEach((function(e){new k(M,e).enableValidation()})),function(){for(;q.firstChild;)q.removeChild(q.firstChild);D.getCards().then((function(e){var n={items:e,renderer:function(e){var n=new t(e,"#card-template",(function(e){return V.open(e.target.src,e.target.alt)}),(function(e){var t=e.target.closest(".elements__element");D.deleteCard(t.id).then((function(e){return t.remove()})).catch((function(e){return console.log(e.message)}))})).getCard();A.addItem(n)}};(A=new r(n,".elements")).renderAll()})).catch((function(e){V.open("https://xn--443-5cd3cgu2f.xn--p1ai/wp-content/uploads/error.jpg",e.message)}))}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QmxILEtBQVksZUFDWjJELFdBQVkseUJDc0VkLElBQU8zQixFQUE4QndFLEVBQUFBLGFBQWQzQyxFLGtYQUF2QixDQUFxQzJDLEVBQXJDLGtCQUNpQnhDLE1BQU1DLEtBQUs3RCxTQUFTNkMsaUJBQWlCakIsSUFFN0NMLFNBQVEsU0FBQW1DLEdBQ0ssSUFBSUYsRUFBY0MsRUFBWUMsR0FDdEN3RSxzQkFJTSxXQUVoQixLQUFNbkMsRUFBYW9DLFlBQ2pCcEMsRUFBYXFDLFlBQVlyQyxFQUFhb0MsWUFHeEM1QixFQUFTOEIsV0FDSjdDLE1BQUssU0FBQXRFLEdBQ0YsSUFBTW9ILEVBQU8sQ0FBQ3BILE1BQU9BLEVBQ1BDLFNBQVUsU0FBQWtHLEdBQ1YsSUFTTVUsRUFUVSxJQUFJOUksRUFBS29JLEVBQ0Esa0JBQ0EsU0FBQTlHLEdBQUcsT0FBSWlHLEVBQVdTLEtBQUsxRyxFQUFJQyxPQUFPTSxJQUFLUCxFQUFJQyxPQUFPTyxRQUNsRCxTQUFBUixHQUNDLElBQU1pQixFQUFVakIsRUFBSUMsT0FBT2dILFFBQVEsc0JBQ25DakIsRUFBU2tCLFdBQVdqRyxFQUFRaEMsSUFDdkJnRyxNQUFLLFNBQUFDLEdBQUcsT0FBSWpFLEVBQVFVLFlBQ3BCd0YsT0FBTSxTQUFBQyxHQUFHLE9BQUlDLFFBQVFDLElBQUlGLEVBQUlHLGVBRWhDRSxVQUM1QjNCLEVBQWE0QixRQUFRRixNQUduQzFCLEVBQWUsSUFBSXJGLEVBQVFzSCxFQUFNLGNBQ3BCQyxlQUVoQmIsT0FBTSxTQUFBQyxHQUNIbkIsRUFBV1MsS0FBSyxrRUFBa0VVLEVBQUlHLFlBR2xHVSxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvc2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL3BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvcG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9wb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvdXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9mb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3V0aWxzL2FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoZGJSZWNvcmQsIGNhcmRTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVCdXR0b25DbGljaykge1xyXG4gICAgICB0aGlzLl9pZCA9IGRiUmVjb3JkLmlkO1xyXG4gICAgICB0aGlzLl9saW5rID0gZGJSZWNvcmQubGluaztcclxuICAgICAgdGhpcy5fbmFtZSA9IGRiUmVjb3JkLm5hbWU7XHJcbiAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjsgICAgICBcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b25DbGljayA9IGhhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrXHJcbiAgICB9XHJcbiAgXHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgXHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ICA9IGRvY3VtZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAgIC5jb250ZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fZWxlbWVudCcpXHJcbiAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICBcclxuICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIFxyXG4gICAgfVxyXG4gIFxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gIFxyXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fbGlrZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fdG9nZ2xlTGlrZSk7XHJcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX19kZWxldGVCdXR0b24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrKTtcclxuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2ltYWdlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVDYXJkQ2xpY2spO1xyXG4gIFxyXG4gICAgfVxyXG4gIFxyXG4gICAgX3RvZ2dsZUxpa2UoZXZ0KSB7XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudHNfX2xpa2VfYWN0aXZlJyk7ICAgIFxyXG4gICAgfSAgICBcclxuICBcclxuICAgIGdldENhcmQoKSB7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICBcclxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICBcclxuICAgICAgdGhpcy5fZWxlbWVudC5pZCA9IHRoaXMuX2lkO1xyXG4gICAgXHJcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX19uYW1lJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19faW1hZ2UnKS5zcmMgICAgICAgID0gdGhpcy5fbGluaztcclxuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2ltYWdlJykuYWx0ICAgICAgICA9IHRoaXMuX25hbWU7XHJcbiAgICAgXHJcbiAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gICAgXHJcbiAgICB9XHJcbiAgXHJcbiAgfSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyBpdGVtcyxyZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jYXJkRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJBbGwoKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoZWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbShjYXJkKSB7XHJcbiAgICAgICAgdGhpcy5fY2FyZEVsZW1lbnRzLmFwcGVuZChjYXJkKTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKGZvcm1TZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwJyk7XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IGV2dCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldnQua2V5PT09XCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgndmlzaWJsZScpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCd2aXNpYmxlJyk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcclxuICAgICAgICB0aGlzLl9mb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc2libGUnKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfSAgICBcclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImV4aXRCdXR0b25cIikpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tICcuL3BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IoZm9ybVNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIoZm9ybVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9iaWdDYXJkSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbiAgICAgICAgdGhpcy5fYmlnQ2FyZENhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKHNyYywgYWx0KSB7XHJcbiAgICAgICAgdGhpcy5fYmlnQ2FyZEltYWdlLnNyYyAgICAgICAgICAgPSBzcmM7XHJcbiAgICAgICAgdGhpcy5fYmlnQ2FyZENhcHRpb24udGV4dENvbnRlbnQgPSBhbHQ7XHJcbiAgICAgICAgc3VwZXIub3BlbigpOyAgICAgICAgXHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9wb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IoZm9ybVNlbGVjdG9yLCBzdWJtaXRIYW5kbGVyKSB7XHJcbiAgICAgICAgc3VwZXIoZm9ybVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyID0gc3VibWl0SGFuZGxlcjtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcblxyXG4gICAgICAgIGNvbnN0IGlucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpO1xyXG5cclxuICAgICAgICB0aGlzLl9mb3JtVmFsdWVzID0ge307XHJcbiAgICAgIFxyXG4gICAgICAgIGlucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHtcclxuICAgICAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5fc3VibWl0SGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IHVzZXJOYW1lU2VsZWN0b3Isb2NjdXBhdGlvblNlbGVjdG9yfSkge1xyXG5cclxuICAgICAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZU9jY3VwYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG9jY3VwYXRpb25TZWxlY3Rvcik7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB7bmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICBvY2N1cGF0aW9uOiB0aGlzLl9wcm9maWxlT2NjdXBhdGlvbi50ZXh0Q29udGVudH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyh7IG5hbWUsb2NjdXBhdGlvbiB9KSB7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX3Byb2ZpbGVPY2N1cGF0aW9uLnRleHRDb250ZW50ID0gb2NjdXBhdGlvbjtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuXG4gIGNvbnN0cnVjdG9yKHBhcmFtZXRyZXMsIGZvcm1FbGVtZW50KSB7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QgICAgICAgICAgICA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChwYXJhbWV0cmVzLmlucHV0U2VsZWN0b3IpKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHBhcmFtZXRyZXMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyAgPSBwYXJhbWV0cmVzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzICAgICAgPSBwYXJhbWV0cmVzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzICAgICAgICAgICA9IHBhcmFtZXRyZXMuZXJyb3JDbGFzczsgICAgICAgXG5cbiAgfVxuXG5cbiAgZW5hYmxlVmFsaWRhdGlvbiAoKSB7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XG4gIFxuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZXZ0KSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZVZhbGlkaXR5KGV2dCk7XG4gICAgICB9KTtcbiAgXG4gICAgfSk7ICBcblxuICB9XG5cbiAgX2hhbmRsZVZhbGlkaXR5KGV2dCkge1xuXG4gICAgY29uc3QgaW5wdXQgPSBldnQudGFyZ2V0O1xuXG4gICAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0Vycm9yKGlucHV0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXQpO1xuICAgIH1cblxuICAgIHRoaXMuX2NoZWNrU3VibWl0dGVyQXZhaWxhYmlsaXR5KCk7ICAgIFxuXG4gIH1cblxuICBfY2hlY2tTdWJtaXR0ZXJBdmFpbGFiaWxpdHkoKSB7XG5cbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSB0aGlzLl9pbnB1dExpc3RbMF0uZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgXG4gICAgaWYgKHRoaXMuX2lucHV0TGlzdC5ldmVyeShpbnB1dCA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCkpIHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgXG4gIH1cbiAgXG4gIF9zaG93RXJyb3IoaW5wdXQpIHtcbiAgXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICBcbiAgICBjb25zdCBzcGFuRXJyb3IgPSBpbnB1dC5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5fZXJyb3JDbGFzcyArIGlucHV0LmlkKTtcbiAgXG4gICAgc3BhbkVycm9yLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIHNwYW5FcnJvci50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICBcbiAgfVxuICBcbiAgX2hpZGVFcnJvcihpbnB1dCkge1xuICBcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gIFxuICAgIGNvbnN0IHNwYW5FcnJvciA9IGlucHV0LmZvcm0ucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLl9lcnJvckNsYXNzICsgaW5wdXQuaWQpO1xuICBcbiAgICBzcGFuRXJyb3IuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gIFxuICB9XG5cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHNlcnZlcikge1xyXG4gICAgICB0aGlzLl9zZXJ2ZXIgPSBzZXJ2ZXI7ICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q2FyZHMoKSB7XHJcblxyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9zZXJ2ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgIHttZXRob2Q6ICdHRVQnfVxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBhZGRDYXJkKGJvZHkpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fc2VydmVyLFxyXG4gICAgICAgICAgICB7bWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICBoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnfSxcclxuICAgICAgICAgICAgIGJvZHk6IGJvZHl9XHJcbiAgICAgICAgICAgKVxyXG4gICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9zZXJ2ZXIgKyAnLycgKyBpZCxcclxuICAgICAgICAgICAge21ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgICAgICBoZWFkZXJzOiB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnfX1cclxuICAgICAgICAgICApXHJcbiAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcclxuICAgIH1cclxuXHJcbn0iLCJleHBvcnQgY29uc3QgaW5wdXREZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50eXBlX25ldy1pdGVtIC5wb3B1cF9faW5wdXRfdHlwZV9saW5lLW9uZScpO1xyXG5leHBvcnQgY29uc3QgaW5wdXRMaW5rICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50eXBlX25ldy1pdGVtIC5wb3B1cF9faW5wdXRfdHlwZV9saW5lLXR3bycpO1xyXG5leHBvcnQgY29uc3QgY2FyZEVsZW1lbnRzICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50cycpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGlucHV0TmFtZSAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudHlwZV9wcm9maWxlIC5wb3B1cF9faW5wdXRfdHlwZV9saW5lLW9uZScpO1xyXG5leHBvcnQgY29uc3QgaW5wdXRPY2N1cGF0aW9uICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50eXBlX3Byb2ZpbGUgLnBvcHVwX19pbnB1dF90eXBlX2xpbmUtdHdvJyk7XHJcblxyXG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvbiAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdEJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYWRkQnV0dG9uICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkQnV0dG9uJyk7XHJcblxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGluZ1BhcmFtZXRyZXMgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiAgICAgICAgICcucG9wdXBfX2NvbnRhaW5lcicsXHJcbiAgaW5wdXRTZWxlY3RvcjogICAgICAgICcucG9wdXBfX2lucHV0JyxcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fc2F2ZUJ1dHRvbicsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogICdwb3B1cF9fc2F2ZUJ1dHRvbl9lcnJvcicsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAgICAgICdwb3B1cF9faW5wdXRfc3R5bGUtZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICAgICAgICAgICAncG9wdXBfX2lucHV0LWVycm9yX3BsYWNlX2xpbmUnXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgaW5pdFVzZXJEYXRhID0ge1xyXG4gIG5hbWU6ICAgICAgICfQltCw0Lot0JjQsiDQmtGD0YHRgtC+JyxcclxuICBvY2N1cGF0aW9uOiAn0JjRgdGB0LvQtdC00L7QstCw0YLQtdC70Ywg0L7QutC10LDQvdCwJ1xyXG59OyIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xuXG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL2NhcmQuanMnO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSAnLi4vY29tcG9uZW50cy9zZWN0aW9uLmpzJztcblxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvcG9wdXBXaXRoSW1hZ2UuanMnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9wb3B1cFdpdGhGb3JtLmpzJztcblxuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uL2NvbXBvbmVudHMvdXNlckluZm8uanMnO1xuXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL2Zvcm1WYWxpZGF0b3IuanMnO1xuXG5pbXBvcnQgQXBpIGZyb20gJy4uL3V0aWxzL2FwaS5qcyc7XG5cbmltcG9ydCB7aW5wdXROYW1lLCBpbnB1dE9jY3VwYXRpb24sIGVkaXRCdXR0b24sIGFkZEJ1dHRvbiwgdmFsaWRhdGluZ1BhcmFtZXRyZXMsIGluaXRVc2VyRGF0YSwgaW5wdXREZXNjcmlwdGlvbiwgaW5wdXRMaW5rLCBjYXJkRWxlbWVudHN9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcyc7XG5cbmxldCBDYXJkc1NlY3Rpb24gPSB1bmRlZmluZWQ7XG5cbi8v0LjQvdC40YbQuNCw0LvQuNC30LDRhtC40Y8gQVBJXG5jb25zdCBjYXJkc0FwaSA9IG5ldyBBcGkoJ2h0dHA6Ly8xMjcuMC4wLjE6MzAwMi9jYXJkcycpO1xuXG4vL3BvcHVwINGBINCx0L7Qu9GM0YjQvtC5INC60LDRgNGC0LjQvdC60L7QuVxuZXhwb3J0IGNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF9fYmlnLWNhcmQnKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy9wb3B1cCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPINC/0YDQvtGE0LDQudC70LBcbmV4cG9ydCBjb25zdCBwcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnR5cGVfcHJvZmlsZScsIGV2dCA9PiB7XG4gICAgXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIFxuICAgIHByb2ZpbGVQb3B1cC5fZ2V0SW5wdXRWYWx1ZXMoKTtcblxuICAgIGN1cnJlbnRVc2VySW5mby5zZXRVc2VySW5mbyhwcm9maWxlUG9wdXAuX2Zvcm1WYWx1ZXMpO1xuXG4gICAgcHJvZmlsZVBvcHVwLmNsb3NlKCk7XG59KTtcblxucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgY29uc3QgdXNlckRhdGEgPSBjdXJyZW50VXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgICBpbnB1dE5hbWUudmFsdWUgICAgICAgPSB1c2VyRGF0YS5uYW1lO1xuICAgIGlucHV0T2NjdXBhdGlvbi52YWx1ZSA9IHVzZXJEYXRhLm9jY3VwYXRpb247XG4gICAgcHJvZmlsZVBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vL3BvcHVwINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8g0L3QvtCy0L7QuSDQutCw0YDRgtC+0YfQutC4XG5leHBvcnQgY29uc3QgbmV3SXRlbVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy50eXBlX25ldy1pdGVtJywgZXZ0ID0+IHtcblxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBcbiAgICBjb25zdCBuYW1lID0gaW5wdXREZXNjcmlwdGlvbi52YWx1ZTtcbiAgICBjb25zdCBsaW5rID0gaW5wdXRMaW5rLnZhbHVlO1xuXG4gICAgY2FyZHNBcGkuYWRkQ2FyZCgnbmFtZT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJyZsaW5rPScgKyBlbmNvZGVVUklDb21wb25lbnQobGluaykpXG4gICAgICAgIC50aGVuKGlkID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY29yZCA9IHtpZDogTnVtYmVyKGlkKSwgXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgICBsaW5rOiBsaW5rfTtcblxuICAgICAgICAgICAgY29uc3QgbmV3Q2FyZCA9IG5ldyBDYXJkKHJlY29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnI2NhcmQtdGVtcGxhdGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2dCA9PiBpbWFnZVBvcHVwLm9wZW4oZXZ0LnRhcmdldC5zcmMsIGV2dC50YXJnZXQuYWx0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldnQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBldnQudGFyZ2V0LmNsb3Nlc3QoJy5lbGVtZW50c19fZWxlbWVudCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzQXBpLmRlbGV0ZUNhcmQoZWxlbWVudC5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IGVsZW1lbnQucmVtb3ZlKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IG5ld0NhcmQuZ2V0Q2FyZCgpO1xuICAgICAgICAgICAgQ2FyZHNTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuXG4gICAgICAgICAgICBuZXdJdGVtUG9wdXAuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7XG4gICAgICAgIH0pXG4gICAgXG59KTtcblxubmV3SXRlbVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBuZXdJdGVtUG9wdXAub3BlbigpO1xufSk7XG5cbi8v0LjQvdC40YbQuNCw0LvQuNC30LDRhtC40Y8g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXG5leHBvcnQgY29uc3QgY3VycmVudFVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHt1c2VyTmFtZVNlbGVjdG9yOiAnLnByb2ZpbGVfX25hbWUnLCBvY2N1cGF0aW9uU2VsZWN0b3I6Jy5wcm9maWxlX19vY2N1cGF0aW9uJ30pO1xuY3VycmVudFVzZXJJbmZvLnNldFVzZXJJbmZvKGluaXRVc2VyRGF0YSk7XG5cbi8v0L/QvtC00LrQu9GO0YfQtdC90LjQtSDQstCw0LvQuNC00LDRhtC40Lgg0YTQvtGA0LzRi1xuY29uc3Qge2Zvcm1TZWxlY3RvciwuLi5wYXJhbWV0cmVzfSA9IHZhbGlkYXRpbmdQYXJhbWV0cmVzO1xuY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZm9ybVNlbGVjdG9yKSk7XG5cbmZvcm1MaXN0LmZvckVhY2goZm9ybUVsZW1lbnQgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHBhcmFtZXRyZXMsIGZvcm1FbGVtZW50KTtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpOyAgICBcbn0pOyAgXG5cbi8v0YDQtdC90LTQtdGA0LjQvdCzINC60LDRgNGC0L7Rh9C10LpcbmNvbnN0IHJlbmRlckNhcmRzID0gKCkgPT4ge1xuXG4gICAgd2hpbGUoY2FyZEVsZW1lbnRzLmZpcnN0Q2hpbGQpIHtcbiAgICAgIGNhcmRFbGVtZW50cy5yZW1vdmVDaGlsZChjYXJkRWxlbWVudHMuZmlyc3RDaGlsZCk7XG4gICAgfTtcbiAgXG4gICAgY2FyZHNBcGkuZ2V0Q2FyZHMoKVxuICAgICAgICAudGhlbihpdGVtcyA9PiB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0ge2l0ZW1zOiBpdGVtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXI6IHJlY29yZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChyZWNvcmQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnI2NhcmQtdGVtcGxhdGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZ0ID0+IGltYWdlUG9wdXAub3BlbihldnQudGFyZ2V0LnNyYywgZXZ0LnRhcmdldC5hbHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZ0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZXZ0LnRhcmdldC5jbG9zZXN0KCcuZWxlbWVudHNfX2VsZW1lbnQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkc0FwaS5kZWxldGVDYXJkKGVsZW1lbnQuaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiBlbGVtZW50LnJlbW92ZSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IG5ld0NhcmQuZ2V0Q2FyZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJkc1NlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7ICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9fTtcblxuICAgICAgICAgICAgQ2FyZHNTZWN0aW9uID0gbmV3IFNlY3Rpb24oZGF0YSwgJy5lbGVtZW50cycpO1xuICAgICAgICAgICAgQ2FyZHNTZWN0aW9uLnJlbmRlckFsbCgpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgIGltYWdlUG9wdXAub3BlbignaHR0cHM6Ly94bi0tNDQzLTVjZDNjZ3UyZi54bi0tcDFhaS93cC1jb250ZW50L3VwbG9hZHMvZXJyb3IuanBnJyxlcnIubWVzc2FnZSk7XG4gICAgICAgIH0pIFxufVxucmVuZGVyQ2FyZHMoKTsiXSwibmFtZXMiOlsiQ2FyZCIsImRiUmVjb3JkIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2siLCJ0aGlzIiwiX2lkIiwiaWQiLCJfbGluayIsImxpbmsiLCJfbmFtZSIsIm5hbWUiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVCdXR0b25DbGljayIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfZWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfdG9nZ2xlTGlrZSIsImV2dCIsInRhcmdldCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9nZXRUZW1wbGF0ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jYXJkRWxlbWVudHMiLCJmb3JFYWNoIiwiZWxlbWVudCIsImNhcmQiLCJhcHBlbmQiLCJQb3B1cCIsImZvcm1TZWxlY3RvciIsIl9wb3B1cCIsIl9mb3JtIiwiX2hhbmRsZUVzY0Nsb3NlIiwia2V5IiwiY2xvc2UiLCJyZW1vdmUiLCJhZGQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJQb3B1cFdpdGhJbWFnZSIsIl9iaWdDYXJkSW1hZ2UiLCJfYmlnQ2FyZENhcHRpb24iLCJQb3B1cFdpdGhGb3JtIiwic3VibWl0SGFuZGxlciIsIl9zdWJtaXRIYW5kbGVyIiwiaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0IiwiVXNlckluZm8iLCJ1c2VyTmFtZVNlbGVjdG9yIiwib2NjdXBhdGlvblNlbGVjdG9yIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVPY2N1cGF0aW9uIiwib2NjdXBhdGlvbiIsIkZvcm1WYWxpZGF0b3IiLCJwYXJhbWV0cmVzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9oYW5kbGVWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUVycm9yIiwiX3Nob3dFcnJvciIsIl9jaGVja1N1Ym1pdHRlckF2YWlsYWJpbGl0eSIsInN1Ym1pdEJ1dHRvbiIsImZvcm0iLCJldmVyeSIsImRpc2FibGVkIiwic3BhbkVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJBcGkiLCJzZXJ2ZXIiLCJfc2VydmVyIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwicmVzIiwianNvbiIsImJvZHkiLCJoZWFkZXJzIiwiaW5wdXREZXNjcmlwdGlvbiIsImlucHV0TGluayIsImNhcmRFbGVtZW50cyIsImlucHV0TmFtZSIsImlucHV0T2NjdXBhdGlvbiIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJ2YWxpZGF0aW5nUGFyYW1ldHJlcyIsIkNhcmRzU2VjdGlvbiIsInVuZGVmaW5lZCIsImNhcmRzQXBpIiwiaW1hZ2VQb3B1cCIsInNldEV2ZW50TGlzdGVuZXJzIiwicHJvZmlsZVBvcHVwIiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJjdXJyZW50VXNlckluZm8iLCJzZXRVc2VySW5mbyIsInVzZXJEYXRhIiwiZ2V0VXNlckluZm8iLCJvcGVuIiwibmV3SXRlbVBvcHVwIiwiYWRkQ2FyZCIsImVuY29kZVVSSUNvbXBvbmVudCIsInJlY29yZCIsIk51bWJlciIsIm5ld0NhcmQiLCJjbG9zZXN0IiwiZGVsZXRlQ2FyZCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsIm1lc3NhZ2UiLCJjYXJkRWxlbWVudCIsImdldENhcmQiLCJhZGRJdGVtIiwiZW5hYmxlVmFsaWRhdGlvbiIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsImdldENhcmRzIiwiZGF0YSIsInJlbmRlckFsbCIsInJlbmRlckNhcmRzIl0sInNvdXJjZVJvb3QiOiIifQ==